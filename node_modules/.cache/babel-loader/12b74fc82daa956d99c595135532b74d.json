{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/gc159/Desktop/nwitter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/gc159/Desktop/nwitter/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\gc159\\\\Desktop\\\\nwitter\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from\"react\";import{dbService,storageService}from\"myFirebase\";import{doc,deleteDoc,updateDoc}from\"firebase/firestore\";import{deleteObject,ref}from\"firebase/storage\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faTrash,faPencilAlt}from\"@fortawesome/free-solid-svg-icons\";import'post.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Post=function Post(_ref){var postObj=_ref.postObj,isOwner=_ref.isOwner;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editing=_useState2[0],setEditing=_useState2[1];var _useState3=useState(postObj.text),_useState4=_slicedToArray(_useState3,2),newPost=_useState4[0],setNwePost=_useState4[1];var onDeleteClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var ok,PostTextRef,urlRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// 게시글 삭제 함수\nok=window.confirm(\"Are you sure you want to delete this post?\");console.log(ok);if(!ok){_context.next=9;break;}PostTextRef=doc(dbService,\"posts\",\"\".concat(postObj.id));// delete post\n_context.next=6;return deleteDoc(PostTextRef);case 6:urlRef=ref(storageService,postObj.attachmentURL);// delete file\n_context.next=9;return deleteObject(urlRef);case 9:case\"end\":return _context.stop();}}},_callee);}));return function onDeleteClick(){return _ref2.apply(this,arguments);};}();// 게시글 편집 여부 토글 함수\nvar toggleEditing=function toggleEditing(){return setEditing(function(prev){return!prev;});};var onSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var PostTextRef;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// 게시글 업데이트\nevent.preventDefault();PostTextRef=doc(dbService,\"posts\",\"\".concat(postObj.id));_context2.next=4;return updateDoc(PostTextRef,{text:newPost});case 4:setEditing(false);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmit(_x){return _ref3.apply(this,arguments);};}();var onChange=function onChange(event){var value=event.target.value;setNwePost(value);};return/*#__PURE__*/_jsx(\"div\",{className:\"post\",children:editing?/*#__PURE__*/ // 게시글 편집 상태\n_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"container postEdit\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newPost,onChange:onChange,required:true,autoFocus:true,className:\"formInput\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Update Post\",className:\"formBtn\"})]}),/*#__PURE__*/_jsx(\"span\",{onClick:toggleEditing,className:\"formBtn cancelBtn\",children:\"Cencel\"})]}):/*#__PURE__*/ // 기본 상태\n_jsxs(_Fragment,{children:[\"  \",postObj.creatorName?/*#__PURE__*/_jsx(\"h4\",{className:\"posterName\",children:postObj.creatorName}):/*#__PURE__*/_jsx(\"h4\",{className:\"posterName\",children:\"\\uC774\\uB984 \\uC124\\uC815 \\uC548\\uD55C \\uBA4D\\uCCAD\\uC774\"}),/*#__PURE__*/_jsx(\"h4\",{children:postObj.text}),postObj.userProfileImg&&/*#__PURE__*/_jsx(\"img\",{className:\"userProfileImg\",src:postObj.userProfileImg?postObj.userProfileImg:require(\"img/user.png\")}),postObj.attachmentURL&&/*#__PURE__*/ // 게시글에 이미지가 있을 경우 이미지 표시\n_jsx(\"img\",{className:\"postImg\",src:postObj.attachmentURL}),isOwner&&/*#__PURE__*/ // 게시글 작성자 본인인 경우 편집,삭제버튼 표시\n_jsxs(\"div\",{className:\"post__actions\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:onDeleteClick,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTrash})}),/*#__PURE__*/_jsx(\"span\",{onClick:toggleEditing,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faPencilAlt})})]})]})});};export default Post;","map":{"version":3,"sources":["C:/Users/gc159/Desktop/nwitter/src/components/Post.js"],"names":["React","useState","dbService","storageService","doc","deleteDoc","updateDoc","deleteObject","ref","FontAwesomeIcon","faTrash","faPencilAlt","Post","postObj","isOwner","editing","setEditing","text","newPost","setNwePost","onDeleteClick","ok","window","confirm","console","log","PostTextRef","id","urlRef","attachmentURL","toggleEditing","prev","onSubmit","event","preventDefault","onChange","value","target","creatorName","userProfileImg","require"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { dbService, storageService  } from \"myFirebase\";\r\nimport { doc, deleteDoc, updateDoc } from \"firebase/firestore\"\r\nimport { deleteObject, ref } from \"firebase/storage\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTrash, faPencilAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport 'post.css' \r\nconst Post = ({ postObj, isOwner }) => {\r\n    const [editing, setEditing] = useState(false);\r\n    const [newPost, setNwePost] = useState(postObj.text);\r\n    const onDeleteClick = async () => {\r\n        // 게시글 삭제 함수\r\n        const ok = window.confirm(\"Are you sure you want to delete this post?\");\r\n        console.log(ok);\r\n        if(ok){\r\n            const PostTextRef = doc(dbService, \"posts\", `${postObj.id}`);\r\n            // delete post\r\n            await deleteDoc(PostTextRef);\r\n            const urlRef = ref(storageService, postObj.attachmentURL)\r\n            // delete file\r\n            await deleteObject(urlRef);\r\n        }\r\n    }\r\n    // 게시글 편집 여부 토글 함수\r\n    const toggleEditing = () => setEditing(prev => !prev);\r\n    const onSubmit = async (event) => {\r\n        // 게시글 업데이트\r\n        event.preventDefault();\r\n        const PostTextRef = doc(dbService, \"posts\", `${postObj.id}`);\r\n        await updateDoc(PostTextRef,{\r\n            text: newPost,\r\n        })\r\n        setEditing(false);\r\n    }\r\n    const onChange = (event) => {\r\n        const {target:{value}} = event;\r\n        setNwePost(value);\r\n    }\r\n    return (\r\n        <div className=\"post\">\r\n            {editing ? ( // 게시글 편집 상태\r\n                <>\r\n                    <form onSubmit={onSubmit}\r\n                    className=\"container postEdit\">\r\n                        <input type=\"text\" value={newPost} onChange={onChange} \r\n                        required autoFocus className=\"formInput\"/>\r\n                        <input type=\"submit\" value=\"Update Post\" className=\"formBtn\"/>\r\n                    </form>\r\n                    <span onClick={toggleEditing}\r\n                    className=\"formBtn cancelBtn\">Cencel</span>\r\n                </>\r\n                ) : ( // 기본 상태\r\n                <>  {postObj.creatorName ? (<h4 className=\"posterName\">{postObj.creatorName}</h4>) : (<h4 className=\"posterName\">이름 설정 안한 멍청이</h4>)}\r\n                    <h4>{postObj.text}</h4>\r\n                    {postObj.userProfileImg &&\r\n                    (<img className=\"userProfileImg\" src={postObj.userProfileImg ? (postObj.userProfileImg):(require(\"img/user.png\"))}/>)}\r\n                    {postObj.attachmentURL && // 게시글에 이미지가 있을 경우 이미지 표시\r\n                    (<img className=\"postImg\" src={postObj.attachmentURL}/>)}\r\n                    {isOwner && ( // 게시글 작성자 본인인 경우 편집,삭제버튼 표시\r\n                        <div className=\"post__actions\">\r\n                            <span onClick={onDeleteClick}>\r\n                                <FontAwesomeIcon icon={faTrash}/>\r\n                            </span>\r\n                            <span onClick={toggleEditing}>\r\n                                <FontAwesomeIcon icon={faPencilAlt}/>\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default Post;"]},"metadata":{},"sourceType":"module"}